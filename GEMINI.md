# Project Context: @grammyjs/parse-mode

## Overview
`@grammyjs/parse-mode` is a library for the [grammY](https://grammy.dev) Telegram Bot framework that simplifies message formatting. It offers a declarative, type-safe API to construct rich text messages (bold, italic, links, mentions, etc.) using tagged template literals (`fmt`) or a fluent builder pattern (`FormattedString`).

The project is designed to be **Deno-first** but is compatible with Node.js via a build process using `deno2node`.

## Key Directories & Files
*   `src/`: Source code.
    *   `mod.ts`: Main entry point, re-exports functionality.
    *   `format.ts`: Core formatting logic and helper functions.
    *   `deps.deno.ts` / `deps.node.ts`: Dependency management for Deno and Node.js.
*   `test/`: Test suite.
*   `deno.jsonc`: Deno configuration and task definitions (primary build/test scripts).
*   `package.json`: Node.js configuration and scripts (delegates to Deno tasks).
*   `tsconfig.json`: TypeScript configuration for the Node.js build.
*   `AGENTS.md`: Specific guidelines for AI agents/contributors.

## Development Workflow

### Prerequisites
*   **Deno**: The primary runtime and toolchain.
*   **Node.js**: Required for building/verifying the Node.js distribution.

### Building & Running
Use `deno task` for most operations.

*   **Verify Everything (Recommended):**
    ```bash
    deno task ok
    ```
    Runs formatting, linting, tests, and type checking.

*   **Run Tests:**
    ```bash
    deno task test
    ```

*   **Type Check:**
    ```bash
    deno task check
    ```

*   **Build for Node.js:**
    ```bash
    deno task build
    ```
    This command uses `deno2node` to compile the Deno source code into a Node.js-compatible distribution. `npm run build` in `package.json` is an alias for this.

### Coding Conventions
*   **Style**: Adhere to the Deno formatter (`deno fmt`) and linter (`deno lint`).
*   **Deno-Centric**: Write code for Deno first. Do not use Node.js-specific globals (like `process` or `__dirname`) in the source code unless abstracted via `deps.*.ts`.
*   **Testing**: Add tests for new features or bug fixes in the `test/` directory. Use `describe` blocks for grouping.
*   **Documentation**: Keep `README.md` and `src/README.md` synchronized. Add JSDoc to exported functions.

## Important Notes
*   **Do not edit `dist/`**: The `dist/` directory is generated by the build process.
*   **Agent Guidelines**: Refer to `AGENTS.md` for detailed instructions on contributing as an AI agent, especially regarding testing strategies and documentation updates.
